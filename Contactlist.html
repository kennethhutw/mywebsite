<!DOCTYPE html>
<html>
<head>
	<title>Leaflet Panel Example</title>
	<meta charset="utf-8" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.css" />
	
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
	<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.fa.js"></script>  -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.js"></script> 
	<script type="text/javascript" src="js/papaparse.min.js"></script> 
	<style type="text/css">
		html {
    height: 100%; 
}

body {
    text-align: center;
    height: 100%;
}
	    .leaflet-map-pane {
    z-index: 1 !important;
	background: #ddd;
}
		</style>

</head>
<body>
    <h3><a href="../mapindex.html"><big>*</big> Example list</a></h3>
	<h3 style="width: 100%;text-align: left;"><big>*</big>  <select id="language-options" name="language-options">
	   <option selected="selected"  value="">Chinese</option>
      <option  value=":en">United States</option>
      <option  value=":ja">Japanese</option>
      <option  value=":ko">Korean</option>
      <option  value=":ru">Russia</option>
	  <option  value=":vi">Vietnamese</option>
    </select></h3>

<button id="btn" onclick="panTo()">Click Me</button>
<table id="grid-data" class="table table-condensed table-hover table-striped">
    <thead>
        <tr>
            <th data-column-id="LineID" >ID</th>
            <th data-column-id="Name">Name</th>
            <th data-column-id="NickName" data-order="desc">NickName</th>
            <th data-column-id="Company"  data-sortable="false">Company</th>
        </tr>
    </thead>
</table>
	<script>
// Read CSV file 

var results;
readCSVfile();
function panTo(){
	$("#grid-data").bootgrid({
    ajax: true,
 
    url: JSON.stringify(results)
});
	//return JSON.stringify(results);  
}

    function readCSVfile() {
        var start, end, rows;
        start = performance.now();
        Papa.parse("data/administrator.xlsx", {
            download: true,
            header: true,
            dynamicTyping: true,
            complete: function (rows) {
                results = rows.data;
                console.log('Parse results:', rows);
			    return results;
            }
        });
    }


</script>
</body>
</html>
